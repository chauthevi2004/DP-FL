[10:51:15.370] [Client 0] Train=750, Val=250, Test=250
[10:51:15.372] [Client 1] Train=750, Val=250, Test=250
[10:51:15.374] [Client 2] Train=750, Val=250, Test=250
[10:51:15.375] [Client 3] Train=750, Val=250, Test=250
[10:51:15.376] [Client 4] Train=750, Val=250, Test=250
[10:51:15.378] [Client 5] Train=750, Val=250, Test=250
[10:51:15.379] [Client 6] Train=750, Val=250, Test=250
[10:51:15.381] [Client 7] Train=750, Val=250, Test=250
[10:51:15.382] [Client 8] Train=750, Val=250, Test=250
[10:51:15.383] [Client 9] Train=750, Val=250, Test=250
[10:51:15.384] [Client 10] Train=750, Val=250, Test=250
[10:51:15.386] [Client 11] Train=750, Val=250, Test=250
[10:51:15.387] [Client 12] Train=750, Val=250, Test=250
[10:51:15.389] [Client 13] Train=750, Val=250, Test=250
[10:51:15.390] [Client 14] Train=750, Val=250, Test=250
[10:51:15.391] [Client 15] Train=750, Val=250, Test=250
[10:51:15.392] [Client 16] Train=750, Val=250, Test=250
[10:51:15.393] [Client 17] Train=750, Val=250, Test=250
[10:51:15.394] [Client 18] Train=750, Val=250, Test=250
[10:51:15.395] [Client 19] Train=750, Val=250, Test=250
[10:51:15.396] [Virtual Client 0-0] Train=750
[10:51:15.397] [Virtual Client 1-0] Train=750
[10:51:15.398] [Virtual Client 2-0] Train=750
[10:51:15.399] [Virtual Client 3-0] Train=750
[10:51:15.400] [Virtual Client 4-0] Train=750
[10:51:15.401] [Virtual Client 5-0] Train=750
[10:51:15.403] [Virtual Client 6-0] Train=750
[10:51:15.403] [Virtual Client 7-0] Train=750
[10:51:15.404] [Virtual Client 8-0] Train=750
[10:51:15.405] [Virtual Client 9-0] Train=750
[10:51:15.406] [Virtual Client 10-0] Train=750
[10:51:15.408] [Virtual Client 11-0] Train=750
[10:51:15.409] [Virtual Client 12-0] Train=750
[10:51:15.410] [Virtual Client 13-0] Train=750
[10:51:15.411] [Virtual Client 14-0] Train=750
[10:51:15.412] [Virtual Client 15-0] Train=750
[10:51:15.413] [Virtual Client 16-0] Train=750
[10:51:15.414] [Virtual Client 17-0] Train=750
[10:51:15.415] [Virtual Client 18-0] Train=750
[10:51:15.416] [Virtual Client 19-0] Train=750
[10:51:15.420] Client Weights: [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
[10:51:15.421] Training Clients:[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
[10:51:15.422] Val Clients:[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
[10:51:15.422] =============== args ================
[10:51:15.423] Namespace(clients=20, virtual_clients=1, lr=0.0003, lr_decay=-1, early=False, batch=16, rounds=100, local_epochs=1, mode='dpadam', pretrain=False, exp=None, save_path='../../experiments/v1.0/checkpoint/RSNA-ICH/seed4/dpadam_rounds100_localE1_lr0.0003_batch16_N20_sr1_VN1_overhead_z1.0_delta0.01_adaclip_adamlr=0.003_PureAvg', resume=False, gpu='0', seed=4, debug=False, data='RSNA-ICH', sample_rate=1, leave='no', merge=False, balance=False, weighted_avg=False, split='UNI', local_bn=False, generalize=False, gn=False, selu=False, comb='times', free=-1, noisy=-1, alpha=1.0, adaclip=True, noclip=False, ema=0.0, mu=0.001, S=10, epsilon=None, noise_multiplier=1.0, delta=0.01, accountant='prv', dp_mode='overhead', balance_split=False, test=False, ckpt='None', adam_lr=0.003, dp2_interval=3, rmsprop_lr=1, ada_vn=False, init_vn=False, ada_stable=False, ada_prog=False, log_path='../../experiments/v1.0/log/RSNA-ICH/seed4/dpadam_rounds100_localE1_lr0.0003_batch16_N20_sr1_VN1_overhead_z1.0_delta0.01_adaclip_adamlr=0.003_PureAvg')
[10:51:19.891] Using noise multiplier=1.0 and sigma on aggregation=0.5 to satisfy (72.38001741987942,0.01)-DP.
[10:51:19.892] Using adaptive clipping.
[10:51:19.893] Using prv accountant.
[10:51:19.970] ============ Round 0, Local train epoch 0 ============
[10:54:40.139]  Site-0         | Train Loss: 0.6350 | Train AUC: 0.6939  | Train Acc: 0.6332  | Train Sen: 0.5870  | Train Spe: 0.6793  | Train F1: 0.6154 
[10:57:58.878]  Site-1         | Train Loss: 0.6141 | Train AUC: 0.7310  | Train Acc: 0.6753  | Train Sen: 0.6694  | Train Spe: 0.6811  | Train F1: 0.6722 
[11:01:18.107]  Site-2         | Train Loss: 0.6368 | Train AUC: 0.7052  | Train Acc: 0.6467  | Train Sen: 0.6594  | Train Spe: 0.6341  | Train F1: 0.6505 
[11:04:40.013]  Site-3         | Train Loss: 0.6500 | Train AUC: 0.6755  | Train Acc: 0.6236  | Train Sen: 0.5590  | Train Spe: 0.6842  | Train F1: 0.5896 
[11:07:56.414]  Site-4         | Train Loss: 0.6113 | Train AUC: 0.7335  | Train Acc: 0.6807  | Train Sen: 0.5794  | Train Spe: 0.7677  | Train F1: 0.6264 
[11:11:15.404]  Site-5         | Train Loss: 0.6256 | Train AUC: 0.7136  | Train Acc: 0.6753  | Train Sen: 0.6048  | Train Spe: 0.7473  | Train F1: 0.6531 
[11:15:10.321]  Site-6         | Train Loss: 0.6400 | Train AUC: 0.6890  | Train Acc: 0.6291  | Train Sen: 0.5350  | Train Spe: 0.7177  | Train F1: 0.5832 
[11:18:38.723]  Site-7         | Train Loss: 0.6094 | Train AUC: 0.7399  | Train Acc: 0.6780  | Train Sen: 0.6543  | Train Spe: 0.7028  | Train F1: 0.6749 
[11:21:57.977]  Site-8         | Train Loss: 0.6413 | Train AUC: 0.6753  | Train Acc: 0.6359  | Train Sen: 0.5505  | Train Spe: 0.7250  | Train F1: 0.6070 
[11:25:18.101]  Site-9         | Train Loss: 0.6163 | Train AUC: 0.7190  | Train Acc: 0.6644  | Train Sen: 0.5641  | Train Spe: 0.7558  | Train F1: 0.6159 
[11:28:38.105]  Site-10        | Train Loss: 0.6405 | Train AUC: 0.6874  | Train Acc: 0.6318  | Train Sen: 0.6508  | Train Spe: 0.6117  | Train F1: 0.6448 
[11:31:59.124]  Site-11        | Train Loss: 0.6479 | Train AUC: 0.6796  | Train Acc: 0.6345  | Train Sen: 0.5674  | Train Spe: 0.6974  | Train F1: 0.6003 
[11:35:16.811]  Site-12        | Train Loss: 0.6180 | Train AUC: 0.7212  | Train Acc: 0.6562  | Train Sen: 0.6434  | Train Spe: 0.6705  | Train F1: 0.6631 
[11:38:37.335]  Site-13        | Train Loss: 0.6444 | Train AUC: 0.6911  | Train Acc: 0.6440  | Train Sen: 0.6299  | Train Spe: 0.6571  | Train F1: 0.6299 
[11:41:58.235]  Site-14        | Train Loss: 0.6242 | Train AUC: 0.7276  | Train Acc: 0.6630  | Train Sen: 0.6166  | Train Spe: 0.7107  | Train F1: 0.6497 
[11:45:15.170]  Site-15        | Train Loss: 0.6387 | Train AUC: 0.7062  | Train Acc: 0.6549  | Train Sen: 0.6083  | Train Spe: 0.6995  | Train F1: 0.6329 
[11:48:34.334]  Site-16        | Train Loss: 0.6493 | Train AUC: 0.6779  | Train Acc: 0.6304  | Train Sen: 0.5836  | Train Spe: 0.6765  | Train F1: 0.6103 
[11:51:49.700]  Site-17        | Train Loss: 0.6203 | Train AUC: 0.7175  | Train Acc: 0.6481  | Train Sen: 0.6371  | Train Spe: 0.6601  | Train F1: 0.6533 
[11:55:07.453]  Site-18        | Train Loss: 0.6204 | Train AUC: 0.7263  | Train Acc: 0.6630  | Train Sen: 0.6614  | Train Spe: 0.6648  | Train F1: 0.6684 
[11:58:26.571]  Site-19        | Train Loss: 0.6416 | Train AUC: 0.6889  | Train Acc: 0.6304  | Train Sen: 0.6632  | Train Spe: 0.5937  | Train F1: 0.6548 
[11:58:28.400] Update sigma on aggregation=0.2785735368728638; clip bound update=5.571470737457275
[11:58:56.824]  Site-0         | Val Loss: 0.6654 | Val AUC: 0.6559 | Val Acc: 0.5960 | Val Sen: 0.9130 | Val Spe: 0.2054 | Val F1: 0.7139
[11:59:22.578]  Site-1         | Val Loss: 0.6775 | Val AUC: 0.6935 | Val Acc: 0.5280 | Val Sen: 0.9204 | Val Spe: 0.2044 | Val F1: 0.6380
[11:59:48.274]  Site-2         | Val Loss: 0.6781 | Val AUC: 0.6310 | Val Acc: 0.5200 | Val Sen: 0.9174 | Val Spe: 0.1473 | Val F1: 0.6491
[12:00:14.382]  Site-3         | Val Loss: 0.6676 | Val AUC: 0.7036 | Val Acc: 0.5760 | Val Sen: 0.9147 | Val Spe: 0.2149 | Val F1: 0.6901
[12:00:40.149]  Site-4         | Val Loss: 0.6722 | Val AUC: 0.6688 | Val Acc: 0.5240 | Val Sen: 0.8871 | Val Spe: 0.1667 | Val F1: 0.6490
[12:01:05.565]  Site-5         | Val Loss: 0.6787 | Val AUC: 0.5933 | Val Acc: 0.5840 | Val Sen: 0.8841 | Val Spe: 0.2143 | Val F1: 0.7011
[12:01:32.230]  Site-6         | Val Loss: 0.6732 | Val AUC: 0.6256 | Val Acc: 0.5680 | Val Sen: 0.8913 | Val Spe: 0.1696 | Val F1: 0.6949
[12:01:57.548]  Site-7         | Val Loss: 0.6676 | Val AUC: 0.6977 | Val Acc: 0.5560 | Val Sen: 0.9098 | Val Spe: 0.2188 | Val F1: 0.6667
[12:02:23.264]  Site-8         | Val Loss: 0.6801 | Val AUC: 0.6851 | Val Acc: 0.5160 | Val Sen: 0.9189 | Val Spe: 0.1942 | Val F1: 0.6277
[12:02:48.926]  Site-9         | Val Loss: 0.6718 | Val AUC: 0.6762 | Val Acc: 0.5680 | Val Sen: 0.9365 | Val Spe: 0.1935 | Val F1: 0.6860
[12:03:15.282]  Site-10        | Val Loss: 0.6888 | Val AUC: 0.6377 | Val Acc: 0.4840 | Val Sen: 0.9174 | Val Spe: 0.1489 | Val F1: 0.6079
[12:03:41.173]  Site-11        | Val Loss: 0.6689 | Val AUC: 0.7247 | Val Acc: 0.5520 | Val Sen: 0.9262 | Val Spe: 0.1953 | Val F1: 0.6686
[12:04:06.893]  Site-12        | Val Loss: 0.6766 | Val AUC: 0.6290 | Val Acc: 0.5440 | Val Sen: 0.8923 | Val Spe: 0.1667 | Val F1: 0.6705
[12:04:32.442]  Site-13        | Val Loss: 0.6788 | Val AUC: 0.6899 | Val Acc: 0.5720 | Val Sen: 0.9478 | Val Spe: 0.2519 | Val F1: 0.6708
[12:04:57.867]  Site-14        | Val Loss: 0.6797 | Val AUC: 0.6379 | Val Acc: 0.5320 | Val Sen: 0.9032 | Val Spe: 0.1667 | Val F1: 0.6569
[12:05:23.233]  Site-15        | Val Loss: 0.6679 | Val AUC: 0.6541 | Val Acc: 0.5920 | Val Sen: 0.9429 | Val Spe: 0.1455 | Val F1: 0.7213
[12:05:48.594]  Site-16        | Val Loss: 0.6818 | Val AUC: 0.6402 | Val Acc: 0.5240 | Val Sen: 0.9016 | Val Spe: 0.1641 | Val F1: 0.6490
[12:06:13.727]  Site-17        | Val Loss: 0.6773 | Val AUC: 0.6614 | Val Acc: 0.5640 | Val Sen: 0.8943 | Val Spe: 0.2441 | Val F1: 0.6687
[12:06:38.703]  Site-18        | Val Loss: 0.6793 | Val AUC: 0.6292 | Val Acc: 0.5520 | Val Sen: 0.9268 | Val Spe: 0.1890 | Val F1: 0.6706
[12:07:04.275]  Site-19        | Val Loss: 0.6689 | Val AUC: 0.6795 | Val Acc: 0.5960 | Val Sen: 0.9237 | Val Spe: 0.2353 | Val F1: 0.7055
[12:07:04.278]  Site-Average | Val Loss: 0.6750 | AUC: 0.6607 | Acc: 0.5524 | Sen: 0.9135 | Spe: 0.1918 | F1: 0.6703
[12:07:04.278]  Best Epoch:0 | Avg Val Acc: 0.5524
[12:07:04.281]  Saving the local and server checkpoint to ../../experiments/v1.0/checkpoint/RSNA-ICH/seed4/dpadam_rounds100_localE1_lr0.0003_batch16_N20_sr1_VN1_overhead_z1.0_delta0.01_adaclip_adamlr=0.003_PureAvg/model_best_0...
