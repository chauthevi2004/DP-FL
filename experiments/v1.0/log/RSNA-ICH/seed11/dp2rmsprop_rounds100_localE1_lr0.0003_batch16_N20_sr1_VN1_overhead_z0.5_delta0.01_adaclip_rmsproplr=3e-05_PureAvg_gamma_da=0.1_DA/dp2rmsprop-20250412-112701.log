[11:27:01.739] [Client 0] Train=750, Val=250, Test=250
[11:27:01.740] [Client 1] Train=750, Val=250, Test=250
[11:27:01.740] [Client 2] Train=750, Val=250, Test=250
[11:27:01.741] [Client 3] Train=750, Val=250, Test=250
[11:27:01.741] [Client 4] Train=750, Val=250, Test=250
[11:27:01.742] [Client 5] Train=750, Val=250, Test=250
[11:27:01.742] [Client 6] Train=750, Val=250, Test=250
[11:27:01.743] [Client 7] Train=750, Val=250, Test=250
[11:27:01.743] [Client 8] Train=750, Val=250, Test=250
[11:27:01.744] [Client 9] Train=750, Val=250, Test=250
[11:27:01.744] [Client 10] Train=750, Val=250, Test=250
[11:27:01.745] [Client 11] Train=750, Val=250, Test=250
[11:27:01.745] [Client 12] Train=750, Val=250, Test=250
[11:27:01.746] [Client 13] Train=750, Val=250, Test=250
[11:27:01.746] [Client 14] Train=750, Val=250, Test=250
[11:27:01.747] [Client 15] Train=750, Val=250, Test=250
[11:27:01.748] [Client 16] Train=750, Val=250, Test=250
[11:27:01.749] [Client 17] Train=750, Val=250, Test=250
[11:27:01.751] [Client 18] Train=750, Val=250, Test=250
[11:27:01.752] [Client 19] Train=750, Val=250, Test=250
[11:27:01.753] [Virtual Client 0-0] Train=750
[11:27:01.754] [Virtual Client 1-0] Train=750
[11:27:01.755] [Virtual Client 2-0] Train=750
[11:27:01.756] [Virtual Client 3-0] Train=750
[11:27:01.756] [Virtual Client 4-0] Train=750
[11:27:01.757] [Virtual Client 5-0] Train=750
[11:27:01.757] [Virtual Client 6-0] Train=750
[11:27:01.758] [Virtual Client 7-0] Train=750
[11:27:01.758] [Virtual Client 8-0] Train=750
[11:27:01.759] [Virtual Client 9-0] Train=750
[11:27:01.759] [Virtual Client 10-0] Train=750
[11:27:01.760] [Virtual Client 11-0] Train=750
[11:27:01.760] [Virtual Client 12-0] Train=750
[11:27:01.760] [Virtual Client 13-0] Train=750
[11:27:01.761] [Virtual Client 14-0] Train=750
[11:27:01.761] [Virtual Client 15-0] Train=750
[11:27:01.762] [Virtual Client 16-0] Train=750
[11:27:01.762] [Virtual Client 17-0] Train=750
[11:27:01.763] [Virtual Client 18-0] Train=750
[11:27:01.763] [Virtual Client 19-0] Train=750
[11:27:01.768] Client Weights: [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
[11:27:01.768] Training Clients:[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
[11:27:01.768] Val Clients:[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
[11:27:01.768] =============== args ================
[11:27:01.768] Namespace(clients=20, virtual_clients=1, lr=0.0003, lr_decay=-1, early=False, batch=16, rounds=100, local_epochs=1, mode='dp2rmsprop', pretrain=False, exp=None, save_path='../../experiments/v1.0/checkpoint/RSNA-ICH/seed11/dp2rmsprop_rounds100_localE1_lr0.0003_batch16_N20_sr1_VN1_overhead_z0.5_delta0.01_adaclip_rmsproplr=3e-05_PureAvg_gamma_da=0.1_DA', resume=False, gpu='0', seed=11, debug=False, data='RSNA-ICH', sample_rate=1, leave='no', merge=False, balance=False, weighted_avg=False, split='UNI', local_bn=False, generalize=False, gn=False, selu=False, comb='times', free=-1, noisy=-1, alpha=1.0, adaclip=True, noclip=False, ema=0.0, mu=0.001, S=10, epsilon=None, noise_multiplier=0.5, delta=0.01, accountant='prv', dp_mode='overhead', balance_split=False, test=False, ckpt='None', adam_lr=0.1, dp2_interval=3, rmsprop_lr=3e-05, ada_vn=False, init_vn=False, ada_stable=False, ada_prog=False, gamma_da=0.1, class_weights=None, domain_adaptation=True, init_lambda=0.01, lambda_schedule='linear', log_path='../../experiments/v1.0/log/RSNA-ICH/seed11/dp2rmsprop_rounds100_localE1_lr0.0003_batch16_N20_sr1_VN1_overhead_z0.5_delta0.01_adaclip_rmsproplr=3e-05_PureAvg_gamma_da=0.1_DA')
[11:27:09.752] Using noise multiplier=0.5 and sigma on aggregation=0.25 to satisfy (245.5990192385698,0.01)-DP.
[11:27:09.752] Using adaptive clipping.
[11:27:09.753] Using prv accountant.
[11:27:09.761] Using domain loss weight (gamma): 0.1
[11:27:09.865] ============ Round 0, Local train epoch 0 ============
[11:32:22.511] Avg Domain Loss: 0.6993
[11:32:22.608]  Site-0         | Train Loss: 0.6248 | Train AUC: 0.7115  | Train Acc: 0.6603  | Train Sen: 0.6435  | Train Spe: 0.6764  | Train F1: 0.6489 
[11:37:23.722] Avg Domain Loss: 0.6990
[11:37:23.806]  Site-1         | Train Loss: 0.6281 | Train AUC: 0.7109  | Train Acc: 0.6495  | Train Sen: 0.5868  | Train Spe: 0.7105  | Train F1: 0.6228 
[11:42:28.025] Avg Domain Loss: 0.6992
[11:42:28.107]  Site-2         | Train Loss: 0.6201 | Train AUC: 0.7210  | Train Acc: 0.6712  | Train Sen: 0.6376  | Train Spe: 0.7026  | Train F1: 0.6523 
[11:47:34.764] Avg Domain Loss: 0.6986
[11:47:34.829]  Site-3         | Train Loss: 0.6230 | Train AUC: 0.7189  | Train Acc: 0.6630  | Train Sen: 0.7216  | Train Spe: 0.5977  | Train F1: 0.6931 
[11:52:45.787] Avg Domain Loss: 0.6985
[11:52:45.887]  Site-4         | Train Loss: 0.6220 | Train AUC: 0.7172  | Train Acc: 0.6603  | Train Sen: 0.5819  | Train Spe: 0.7330  | Train F1: 0.6224 
[11:57:56.927] Avg Domain Loss: 0.6987
[11:57:57.062]  Site-5         | Train Loss: 0.6362 | Train AUC: 0.6967  | Train Acc: 0.6359  | Train Sen: 0.6283  | Train Spe: 0.6436  | Train F1: 0.6369 
[12:03:05.720] Avg Domain Loss: 0.7022
[12:03:05.823]  Site-6         | Train Loss: 0.6222 | Train AUC: 0.7255  | Train Acc: 0.6821  | Train Sen: 0.6881  | Train Spe: 0.6753  | Train F1: 0.6953 
[12:08:09.552] Avg Domain Loss: 0.6966
[12:08:09.697]  Site-7         | Train Loss: 0.6248 | Train AUC: 0.7099  | Train Acc: 0.6590  | Train Sen: 0.6436  | Train Spe: 0.6750  | Train F1: 0.6585 
[12:13:27.362] Avg Domain Loss: 0.6977
[12:13:27.434]  Site-8         | Train Loss: 0.6168 | Train AUC: 0.7327  | Train Acc: 0.7024  | Train Sen: 0.6568  | Train Spe: 0.7493  | Train F1: 0.6911 
[12:18:36.806] Avg Domain Loss: 0.6979
[12:18:36.877]  Site-9         | Train Loss: 0.6335 | Train AUC: 0.6973  | Train Acc: 0.6630  | Train Sen: 0.6640  | Train Spe: 0.6620  | Train F1: 0.6711 
[12:23:38.289] Avg Domain Loss: 0.7009
[12:23:38.378]  Site-10        | Train Loss: 0.5946 | Train AUC: 0.7436  | Train Acc: 0.6861  | Train Sen: 0.6206  | Train Spe: 0.7520  | Train F1: 0.6647 
[12:28:49.924] Avg Domain Loss: 0.6978
[12:28:50.033]  Site-11        | Train Loss: 0.6513 | Train AUC: 0.6844  | Train Acc: 0.6277  | Train Sen: 0.5663  | Train Spe: 0.6872  | Train F1: 0.5994 
[12:33:52.974] Avg Domain Loss: 0.6983
[12:33:53.066]  Site-12        | Train Loss: 0.6594 | Train AUC: 0.6646  | Train Acc: 0.6264  | Train Sen: 0.5738  | Train Spe: 0.6784  | Train F1: 0.6043 
[12:39:02.336] Avg Domain Loss: 0.7020
[12:39:02.433]  Site-13        | Train Loss: 0.6412 | Train AUC: 0.6937  | Train Acc: 0.6603  | Train Sen: 0.6087  | Train Spe: 0.7059  | Train F1: 0.6269 
[12:44:17.740] Avg Domain Loss: 0.6970
[12:44:17.830]  Site-14        | Train Loss: 0.6240 | Train AUC: 0.7197  | Train Acc: 0.6549  | Train Sen: 0.6400  | Train Spe: 0.6704  | Train F1: 0.6540 
[12:49:27.702] Avg Domain Loss: 0.6972
[12:49:27.796]  Site-15        | Train Loss: 0.6343 | Train AUC: 0.7003  | Train Acc: 0.6617  | Train Sen: 0.6515  | Train Spe: 0.6722  | Train F1: 0.6612 
[12:54:35.694] Avg Domain Loss: 0.6952
[12:54:35.821]  Site-16        | Train Loss: 0.6268 | Train AUC: 0.7093  | Train Acc: 0.6753  | Train Sen: 0.6141  | Train Spe: 0.7364  | Train F1: 0.6541 
[12:59:44.155] Avg Domain Loss: 0.6973
[12:59:44.224]  Site-17        | Train Loss: 0.6563 | Train AUC: 0.6657  | Train Acc: 0.6291  | Train Sen: 0.5282  | Train Spe: 0.7225  | Train F1: 0.5781 
[13:04:48.339] Avg Domain Loss: 0.6975
[13:04:48.415]  Site-18        | Train Loss: 0.6248 | Train AUC: 0.6937  | Train Acc: 0.6277  | Train Sen: 0.5730  | Train Spe: 0.6810  | Train F1: 0.6029 
[13:09:56.385] Avg Domain Loss: 0.7009
[13:09:56.462]  Site-19        | Train Loss: 0.6442 | Train AUC: 0.6910  | Train Acc: 0.6386  | Train Sen: 0.6388  | Train Spe: 0.6384  | Train F1: 0.6405 
[13:09:58.495] Update sigma on aggregation=0.13948824405670165; clip bound update=5.579529762268066
[13:10:43.068]  Site-0         | Val Loss: 2.4341 | Val AUC: 0.6754 | Val Acc: 0.4920 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6595
[13:11:22.126]  Site-1         | Val Loss: 2.6757 | Val AUC: 0.6965 | Val Acc: 0.4560 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6264
[13:12:02.180]  Site-2         | Val Loss: 2.4746 | Val AUC: 0.6403 | Val Acc: 0.5000 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6667
[13:12:43.663]  Site-3         | Val Loss: 2.5392 | Val AUC: 0.6413 | Val Acc: 0.4880 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6559
[13:13:24.481]  Site-4         | Val Loss: 2.7018 | Val AUC: 0.6750 | Val Acc: 0.4520 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6226
[13:14:05.131]  Site-5         | Val Loss: 2.4957 | Val AUC: 0.6482 | Val Acc: 0.4960 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6631
[13:14:45.036]  Site-6         | Val Loss: 2.5255 | Val AUC: 0.6746 | Val Acc: 0.4800 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6486
[13:15:25.712]  Site-7         | Val Loss: 2.4606 | Val AUC: 0.6934 | Val Acc: 0.4960 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6631
[13:16:05.606]  Site-8         | Val Loss: 2.2647 | Val AUC: 0.6960 | Val Acc: 0.5240 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6877
[13:16:44.022]  Site-9         | Val Loss: 2.2825 | Val AUC: 0.6615 | Val Acc: 0.5360 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6979
[13:17:24.393]  Site-10        | Val Loss: 2.4543 | Val AUC: 0.5959 | Val Acc: 0.5120 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6772
[13:18:03.103]  Site-11        | Val Loss: 2.5633 | Val AUC: 0.6533 | Val Acc: 0.4800 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6486
[13:18:41.800]  Site-12        | Val Loss: 2.6233 | Val AUC: 0.6433 | Val Acc: 0.4680 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6376
[13:19:20.669]  Site-13        | Val Loss: 2.2894 | Val AUC: 0.6758 | Val Acc: 0.5280 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6911
[13:20:00.249]  Site-14        | Val Loss: 2.2090 | Val AUC: 0.7151 | Val Acc: 0.5280 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6911
[13:20:40.579]  Site-15        | Val Loss: 2.1425 | Val AUC: 0.6864 | Val Acc: 0.5560 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.7147
[13:21:20.142]  Site-16        | Val Loss: 2.5560 | Val AUC: 0.6912 | Val Acc: 0.4720 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6413
[13:21:59.439]  Site-17        | Val Loss: 2.2160 | Val AUC: 0.6696 | Val Acc: 0.5440 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.7047
[13:22:39.664]  Site-18        | Val Loss: 2.3404 | Val AUC: 0.7105 | Val Acc: 0.5160 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6807
[13:23:20.018]  Site-19        | Val Loss: 2.5694 | Val AUC: 0.6719 | Val Acc: 0.4720 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6413
[13:23:20.020]  Site-Average | Val Loss: 2.4409 | AUC: 0.6708 | Acc: 0.4998 | Sen: 1.0000 | Spe: 0.0000 | F1: 0.6660
[13:23:20.020]  Best Epoch:0 | Avg Val Acc: 0.4998
[13:23:20.028]  Saving the local and server checkpoint to ../../experiments/v1.0/checkpoint/RSNA-ICH/seed11/dp2rmsprop_rounds100_localE1_lr0.0003_batch16_N20_sr1_VN1_overhead_z0.5_delta0.01_adaclip_rmsproplr=3e-05_PureAvg_gamma_da=0.1_DA/model_best_0...
