[08:12:36.680] [Client 0] Train=750, Val=250, Test=250
[08:12:36.680] [Client 1] Train=750, Val=250, Test=250
[08:12:36.681] [Client 2] Train=750, Val=250, Test=250
[08:12:36.681] [Client 3] Train=750, Val=250, Test=250
[08:12:36.682] [Client 4] Train=750, Val=250, Test=250
[08:12:36.682] [Client 5] Train=750, Val=250, Test=250
[08:12:36.683] [Client 6] Train=750, Val=250, Test=250
[08:12:36.683] [Client 7] Train=750, Val=250, Test=250
[08:12:36.684] [Client 8] Train=750, Val=250, Test=250
[08:12:36.684] [Client 9] Train=750, Val=250, Test=250
[08:12:36.684] [Client 10] Train=750, Val=250, Test=250
[08:12:36.685] [Client 11] Train=750, Val=250, Test=250
[08:12:36.685] [Client 12] Train=750, Val=250, Test=250
[08:12:36.686] [Client 13] Train=750, Val=250, Test=250
[08:12:36.686] [Client 14] Train=750, Val=250, Test=250
[08:12:36.686] [Client 15] Train=750, Val=250, Test=250
[08:12:36.687] [Client 16] Train=750, Val=250, Test=250
[08:12:36.687] [Client 17] Train=750, Val=250, Test=250
[08:12:36.688] [Client 18] Train=750, Val=250, Test=250
[08:12:36.688] [Client 19] Train=750, Val=250, Test=250
[08:12:36.689] [Virtual Client 0-0] Train=750
[08:12:36.689] [Virtual Client 1-0] Train=750
[08:12:36.690] [Virtual Client 2-0] Train=750
[08:12:36.690] [Virtual Client 3-0] Train=750
[08:12:36.691] [Virtual Client 4-0] Train=750
[08:12:36.691] [Virtual Client 5-0] Train=750
[08:12:36.692] [Virtual Client 6-0] Train=750
[08:12:36.692] [Virtual Client 7-0] Train=750
[08:12:36.693] [Virtual Client 8-0] Train=750
[08:12:36.694] [Virtual Client 9-0] Train=750
[08:12:36.694] [Virtual Client 10-0] Train=750
[08:12:36.694] [Virtual Client 11-0] Train=750
[08:12:36.695] [Virtual Client 12-0] Train=750
[08:12:36.695] [Virtual Client 13-0] Train=750
[08:12:36.696] [Virtual Client 14-0] Train=750
[08:12:36.696] [Virtual Client 15-0] Train=750
[08:12:36.697] [Virtual Client 16-0] Train=750
[08:12:36.697] [Virtual Client 17-0] Train=750
[08:12:36.697] [Virtual Client 18-0] Train=750
[08:12:36.698] [Virtual Client 19-0] Train=750
[08:12:36.702] Client Weights: [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
[08:12:36.703] Training Clients:[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
[08:12:36.703] Val Clients:[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
[08:12:36.703] =============== args ================
[08:12:36.703] Namespace(clients=20, virtual_clients=1, lr=0.0003, lr_decay=-1, early=False, batch=16, rounds=100, local_epochs=1, mode='dp2rmsprop', pretrain=False, exp=None, save_path='../../experiments/v1.0/checkpoint/RSNA-ICH/seed11/dp2rmsprop_rounds100_localE1_lr0.0003_batch16_N20_sr1_VN1_overhead_z0.5_delta0.01_adaclip_rmsproplr=3e-05_PureAvg_gamma_da=0.1_DA', resume=False, gpu='0', seed=11, debug=False, data='RSNA-ICH', sample_rate=1, leave='no', merge=False, balance=False, weighted_avg=False, split='UNI', local_bn=False, generalize=False, gn=False, selu=False, comb='times', free=-1, noisy=-1, alpha=1.0, adaclip=True, noclip=False, ema=0.0, mu=0.001, S=10, epsilon=None, noise_multiplier=0.5, delta=0.01, accountant='prv', dp_mode='overhead', balance_split=False, test=False, ckpt='None', adam_lr=0.1, dp2_interval=3, rmsprop_lr=3e-05, ada_vn=False, init_vn=False, ada_stable=False, ada_prog=False, gamma_da=0.1, class_weights=None, domain_adaptation=True, log_path='../../experiments/v1.0/log/RSNA-ICH/seed11/dp2rmsprop_rounds100_localE1_lr0.0003_batch16_N20_sr1_VN1_overhead_z0.5_delta0.01_adaclip_rmsproplr=3e-05_PureAvg_gamma_da=0.1_DA')
[08:12:43.061] Using noise multiplier=0.5 and sigma on aggregation=0.25 to satisfy (245.5990192385698,0.01)-DP.
[08:12:43.062] Using adaptive clipping.
[08:12:43.062] Using prv accountant.
[08:12:43.066] Using domain loss weight (gamma): 0.1
[08:12:43.136] ============ Round 0, Local train epoch 0 ============
[08:16:45.596] Avg Domain Loss: 0.6993
[08:16:45.676]  Site-0         | Train Loss: 0.6248 | Train AUC: 0.7115  | Train Acc: 0.6603  | Train Sen: 0.6435  | Train Spe: 0.6764  | Train F1: 0.6489 
[08:20:43.941] Avg Domain Loss: 0.6990
[08:20:44.006]  Site-1         | Train Loss: 0.6281 | Train AUC: 0.7109  | Train Acc: 0.6495  | Train Sen: 0.5868  | Train Spe: 0.7105  | Train F1: 0.6228 
[08:24:45.190] Avg Domain Loss: 0.6992
[08:24:45.264]  Site-2         | Train Loss: 0.6201 | Train AUC: 0.7210  | Train Acc: 0.6712  | Train Sen: 0.6376  | Train Spe: 0.7026  | Train F1: 0.6523 
[08:28:45.671] Avg Domain Loss: 0.6986
[08:28:45.753]  Site-3         | Train Loss: 0.6230 | Train AUC: 0.7189  | Train Acc: 0.6630  | Train Sen: 0.7216  | Train Spe: 0.5977  | Train F1: 0.6931 
[08:32:54.544] Avg Domain Loss: 0.6985
[08:32:54.609]  Site-4         | Train Loss: 0.6220 | Train AUC: 0.7172  | Train Acc: 0.6603  | Train Sen: 0.5819  | Train Spe: 0.7330  | Train F1: 0.6224 
[08:37:04.678] Avg Domain Loss: 0.6987
[08:37:04.745]  Site-5         | Train Loss: 0.6362 | Train AUC: 0.6967  | Train Acc: 0.6359  | Train Sen: 0.6283  | Train Spe: 0.6436  | Train F1: 0.6369 
[08:41:16.113] Avg Domain Loss: 0.7022
[08:41:16.291]  Site-6         | Train Loss: 0.6222 | Train AUC: 0.7255  | Train Acc: 0.6821  | Train Sen: 0.6881  | Train Spe: 0.6753  | Train F1: 0.6953 
[08:45:18.611] Avg Domain Loss: 0.6966
[08:45:18.679]  Site-7         | Train Loss: 0.6248 | Train AUC: 0.7099  | Train Acc: 0.6590  | Train Sen: 0.6436  | Train Spe: 0.6750  | Train F1: 0.6585 
[08:49:21.693] Avg Domain Loss: 0.6977
[08:49:21.779]  Site-8         | Train Loss: 0.6168 | Train AUC: 0.7327  | Train Acc: 0.7024  | Train Sen: 0.6568  | Train Spe: 0.7493  | Train F1: 0.6911 
[08:53:23.808] Avg Domain Loss: 0.6979
[08:53:23.870]  Site-9         | Train Loss: 0.6335 | Train AUC: 0.6973  | Train Acc: 0.6630  | Train Sen: 0.6640  | Train Spe: 0.6620  | Train F1: 0.6711 
[08:57:29.107] Avg Domain Loss: 0.7009
[08:57:29.171]  Site-10        | Train Loss: 0.5946 | Train AUC: 0.7436  | Train Acc: 0.6861  | Train Sen: 0.6206  | Train Spe: 0.7520  | Train F1: 0.6647 
[09:01:33.021] Avg Domain Loss: 0.6978
[09:01:33.071]  Site-11        | Train Loss: 0.6513 | Train AUC: 0.6844  | Train Acc: 0.6277  | Train Sen: 0.5663  | Train Spe: 0.6872  | Train F1: 0.5994 
[09:05:36.947] Avg Domain Loss: 0.6983
[09:05:37.024]  Site-12        | Train Loss: 0.6594 | Train AUC: 0.6646  | Train Acc: 0.6264  | Train Sen: 0.5738  | Train Spe: 0.6784  | Train F1: 0.6043 
[09:09:48.004] Avg Domain Loss: 0.7020
[09:09:48.071]  Site-13        | Train Loss: 0.6412 | Train AUC: 0.6937  | Train Acc: 0.6603  | Train Sen: 0.6087  | Train Spe: 0.7059  | Train F1: 0.6269 
[09:13:49.888] Avg Domain Loss: 0.6970
[09:13:49.999]  Site-14        | Train Loss: 0.6240 | Train AUC: 0.7197  | Train Acc: 0.6549  | Train Sen: 0.6400  | Train Spe: 0.6704  | Train F1: 0.6540 
[09:18:01.022] Avg Domain Loss: 0.6972
[09:18:01.130]  Site-15        | Train Loss: 0.6343 | Train AUC: 0.7003  | Train Acc: 0.6617  | Train Sen: 0.6515  | Train Spe: 0.6722  | Train F1: 0.6612 
[09:22:00.668] Avg Domain Loss: 0.6952
[09:22:00.744]  Site-16        | Train Loss: 0.6268 | Train AUC: 0.7093  | Train Acc: 0.6753  | Train Sen: 0.6141  | Train Spe: 0.7364  | Train F1: 0.6541 
[09:26:10.593] Avg Domain Loss: 0.6973
[09:26:10.652]  Site-17        | Train Loss: 0.6563 | Train AUC: 0.6657  | Train Acc: 0.6291  | Train Sen: 0.5282  | Train Spe: 0.7225  | Train F1: 0.5781 
[09:30:23.877] Avg Domain Loss: 0.6975
[09:30:23.940]  Site-18        | Train Loss: 0.6248 | Train AUC: 0.6937  | Train Acc: 0.6277  | Train Sen: 0.5730  | Train Spe: 0.6810  | Train F1: 0.6029 
[09:34:28.550] Avg Domain Loss: 0.7009
[09:34:28.606]  Site-19        | Train Loss: 0.6442 | Train AUC: 0.6910  | Train Acc: 0.6386  | Train Sen: 0.6388  | Train Spe: 0.6384  | Train F1: 0.6405 
[09:34:30.269] Update sigma on aggregation=0.13948824405670165; clip bound update=5.579529762268066
[09:35:04.972]  Site-0         | Val Loss: 2.4341 | Val AUC: 0.6754 | Val Acc: 0.4920 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6595
[09:35:36.122]  Site-1         | Val Loss: 2.6757 | Val AUC: 0.6965 | Val Acc: 0.4560 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6264
[09:36:07.286]  Site-2         | Val Loss: 2.4746 | Val AUC: 0.6403 | Val Acc: 0.5000 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6667
[09:36:38.271]  Site-3         | Val Loss: 2.5392 | Val AUC: 0.6413 | Val Acc: 0.4880 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6559
[09:37:09.417]  Site-4         | Val Loss: 2.7018 | Val AUC: 0.6750 | Val Acc: 0.4520 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6226
[09:37:40.231]  Site-5         | Val Loss: 2.4957 | Val AUC: 0.6482 | Val Acc: 0.4960 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6631
[09:38:10.698]  Site-6         | Val Loss: 2.5255 | Val AUC: 0.6746 | Val Acc: 0.4800 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6486
[09:38:42.342]  Site-7         | Val Loss: 2.4606 | Val AUC: 0.6934 | Val Acc: 0.4960 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6631
[09:39:14.312]  Site-8         | Val Loss: 2.2647 | Val AUC: 0.6960 | Val Acc: 0.5240 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6877
[09:39:46.178]  Site-9         | Val Loss: 2.2825 | Val AUC: 0.6615 | Val Acc: 0.5360 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6979
[09:40:16.825]  Site-10        | Val Loss: 2.4543 | Val AUC: 0.5959 | Val Acc: 0.5120 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6772
[09:40:47.821]  Site-11        | Val Loss: 2.5633 | Val AUC: 0.6533 | Val Acc: 0.4800 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6486
[09:41:19.092]  Site-12        | Val Loss: 2.6233 | Val AUC: 0.6433 | Val Acc: 0.4680 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6376
[09:41:50.026]  Site-13        | Val Loss: 2.2894 | Val AUC: 0.6758 | Val Acc: 0.5280 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6911
[09:42:20.451]  Site-14        | Val Loss: 2.2090 | Val AUC: 0.7151 | Val Acc: 0.5280 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6911
[09:42:51.856]  Site-15        | Val Loss: 2.1425 | Val AUC: 0.6864 | Val Acc: 0.5560 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.7147
[09:43:24.507]  Site-16        | Val Loss: 2.5560 | Val AUC: 0.6912 | Val Acc: 0.4720 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6413
[09:43:55.620]  Site-17        | Val Loss: 2.2160 | Val AUC: 0.6696 | Val Acc: 0.5440 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.7047
[09:44:26.795]  Site-18        | Val Loss: 2.3404 | Val AUC: 0.7105 | Val Acc: 0.5160 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6807
[09:44:57.235]  Site-19        | Val Loss: 2.5694 | Val AUC: 0.6719 | Val Acc: 0.4720 | Val Sen: 1.0000 | Val Spe: 0.0000 | Val F1: 0.6413
[09:44:57.236]  Site-Average | Val Loss: 2.4409 | AUC: 0.6708 | Acc: 0.4998 | Sen: 1.0000 | Spe: 0.0000 | F1: 0.6660
[09:44:57.237]  Best Epoch:0 | Avg Val Acc: 0.4998
[09:44:57.244]  Saving the local and server checkpoint to ../../experiments/v1.0/checkpoint/RSNA-ICH/seed11/dp2rmsprop_rounds100_localE1_lr0.0003_batch16_N20_sr1_VN1_overhead_z0.5_delta0.01_adaclip_rmsproplr=3e-05_PureAvg_gamma_da=0.1_DA/model_best_0...
